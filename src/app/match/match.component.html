<main>
    <div class="header"></div>

    <ng-template #deleteChatContent let-modal>
        <div class="modal-header align-items-center">
            <h4 class="modal-title">{{ "DELETE_CHAT" | translate }}</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="{{ 'CLOSE' | translate }}"
                (click)="modal.dismiss('Cross click')">
                <span class="btn-inner--icon">✖</span>
            </button>
        </div>
        <div class="modal-body text-center">
            <label class="m-4">{{ "ARE_YOU_SURE_YOU_WANT_TO_DELETE_CHAT" | translate }}</label>
        </div>
        <div class="modal-footer">
            <button class="btn btn-block btn-default" (click)="modal.dismiss('No button click')">
                {{ "NO" | translate }}
            </button>
            <button class="btn btn-block btn-danger m-0" (click)="handleDeleteChat(modal.dismiss)">
                {{ "YES" | translate }}
            </button>
        </div>
    </ng-template>

    <ng-template #reportUserContent let-modal>
        <div class="modal-header align-items-center">
            <h4 class="modal-title">{{ "REPORT_USER" | translate }}</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="{{ 'CLOSE' | translate }}"
                (click)="modal.dismiss('Cross click')">
                <span class="btn-inner--icon">✖</span>
            </button>
        </div>
        <div class="modal-body text-justified">
            <label class="mb-3">{{ "ARE_YOU_SURE_YOU_WANT_TO_REPORT_USER_1" | translate }}</label>
            <label class="mb-4">{{ "ARE_YOU_SURE_YOU_WANT_TO_REPORT_USER_2" | translate }}</label>
            <textarea #reportReason name="reason" id="reason" autosize class="form-control report-reason" [ngClass]="{ 'is-invalid': reportReason.value === '' }" placeholder="{{ 'REPORT_REASON' | translate }}"></textarea>
        </div>
        <div class="modal-footer">
            <button class="btn btn-block btn-default" (click)="modal.dismiss('No button click')">
                {{ "NO" | translate }}
            </button>
            <button class="btn btn-block btn-danger m-0" (click)="handleReportUser(reportReason.value, modal.dismiss)" [disabled]="reportReason.value === ''">
                {{ "YES" | translate }}
            </button>
        </div>
    </ng-template>

    <ng-template #undoMatchContainer let-modal>
        <div class="modal-header align-items-center">
            <h4 class="modal-title">{{ "UNDO_MATCH" | translate }}</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="{{ 'CLOSE' | translate }}"
                (click)="modal.dismiss('Cross click')">
                <span class="btn-inner--icon">✖</span>
            </button>
        </div>
        <div class="modal-body text-center">
            <label class="m-4">{{ "ARE_YOU_SURE_YOU_WANT_TO_UNDO_MATCH" | translate }}</label>
        </div>
        <div class="modal-footer">
            <button class="btn btn-block btn-default" (click)="modal.dismiss('No button click')">
                {{ "NO" | translate }}
            </button>
            <button class="btn btn-block btn-danger m-0" (click)="handleUndoMatch(modal.dismiss)">
                {{ "YES" | translate }}
            </button>
        </div>
    </ng-template>

    <ng-template #matchContainer let-modal>
        <div class="modal-header align-items-center">
            <h4 class="modal-title">{{ "ITS_A_MATCH" | translate }}</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="{{ 'CLOSE' | translate }}"
                (click)="modal.dismiss('Cross click')">
                <span class="btn-inner--icon">✖</span>
            </button>
        </div>
        <div class="modal-body text-center">
            <label class="m-4">{{ "YOU_HAVE_NEW_MATCH_WHAT_DO_YOU_WANT_TO_DO" | translate }}</label>
        </div>
        <div class="modal-footer">
            <button class="btn btn-block btn-default" (click)="modal.dismiss('No button click')">
                {{ "CLOSE" | translate }}
            </button>
            <button class="btn btn-default" (click)="openChatByUser(currentUserSelected); modal.dismiss('Open Chat click')">
                {{ "OPEN_CHAT" | translate }}
            </button>
            <button class="btn btn-default" (click)="undoMatch(currentUserSelected); modal.dismiss('Undo Match click')">
                {{ "UNDO_MATCH" | translate }}
            </button>
        </div>
    </ng-template>

    <ng-template #deleteLikeContainer let-modal>
        <div class="modal-header align-items-center">
            <h4 class="modal-title">{{ "DELETE_LIKE" | translate }}</h4>
            <button type="button" class="close" data-dismiss="modal" aria-label="{{ 'CLOSE' | translate }}"
                (click)="modal.dismiss('Cross click')">
                <span class="btn-inner--icon">✖</span>
            </button>
        </div>
        <div class="modal-body text-center">
            <label class="m-4">{{ "ARE_YOU_SURE_YOU_WANT_TO_DELETE_LIKE" | translate }}</label>
        </div>
        <div class="modal-footer">
            <button class="btn btn-block btn-default" (click)="modal.dismiss('No button click')">
                {{ "NO" | translate }}
            </button>
            <button class="btn btn-block btn-danger m-0" (click)="handleDeleteLike(modal.dismiss)">
                {{ "YES" | translate }}
            </button>
        </div>
    </ng-template>

    <section class="section-shaped">
        <!-- Background circles -->
        <div class="shape shape-style-1 shape-primary">
            <span class="span-150"></span>
            <span class="span-50"></span>
            <span class="span-50"></span>
            <span class="span-75"></span>
            <span class="span-100"></span>
            <span class="span-75"></span>
            <span class="span-50"></span>
            <span class="span-100"></span>
            <span class="span-50"></span>
            <span class="span-100"></span>
        </div>
        <div class="container-fluid p-0 h-100">
            <div class="row m-0 w-100">
                <!-- START - Main Window -->
                <div class="d-flex col-lg-4 col-12 bg-white shadow p-0 overflow-hidden limit-height front sidebar" [class.open]="isSidebarOpen">
                    <div class="w-100">
                        <div class="underline-container">
                            <ul>
                                <li class="" [class.active]="activeTab == matchTabEnum.Messages">
                                    <a class="text-dark" (click)="changeTab(matchTabEnum.Messages)" href="javascript:void(0)">{{ 'MESSAGES' | translate }}</a>
                                </li>
                                <li class="" [class.active]="activeTab == matchTabEnum.Matches">
                                    <a class="text-dark" (click)="changeTab(matchTabEnum.Matches)" href="javascript:void(0)">{{ 'MATCHES' | translate }}</a>
                                </li>
                                <li class="" [class.active]="activeTab == matchTabEnum.Likes">
                                    <a class="text-dark" (click)="changeTab(matchTabEnum.Likes)" href="javascript:void(0)">{{ 'LIKES' | translate }}</a>
                                </li>
                            </ul>
                            <hr
                                class="line"
                                [class.messages-selected]="activeTab == matchTabEnum.Messages"
                                [class.matches-selected]="activeTab == matchTabEnum.Matches"
                                [class.likes-selected]="activeTab == matchTabEnum.Likes"
                            >
                        </div>
                        <!-- START - Tabs -->
                        <div class="h-100 position-relative">
                            <!-- START - Messages Tab -->
                            <div *ngIf="chatsLoaded | async" class="h-100 w-100 position-absolute d-flex swipe-animation"
                                [style]="activeTab == matchTabEnum.Messages ? 'transform: translate(0%);' : 'transform: translate(-100%);'">
                                <div *ngIf="chats.length == 0" class="p-3 w-100 d-flex flex-column justify-content-center align-items-center">
                                    <div class="title text-center">
                                        <h4 class="display-4 font-weight-700">{{ "NO_CHATS" | translate }}</h4>
                                    </div>
                                    <div class="text-center">
                                        <p class="px-md text-dark">{{ "NO_CHATS_DESCRIPTION" | translate }}</p>
                                    </div>
                                </div>
                                <div *ngIf="chats.length > 0" class="py-3 w-100 scroll">
                                    <app-messages *ngFor="let chat of chats" [chat]="chat" [user]="user" (openChatEvent)="openChat($event)"></app-messages>
                                </div>
                            </div>
                            <!-- END - Messages Tab -->
                            <!-- START - Matches Tab -->
                            <div *ngIf="matchesLoaded | async" class="h-100 w-100 position-absolute d-flex swipe-animation"
                                [style]="activeTab == matchTabEnum.Messages ? 'transform: translate(100%);' : activeTab == matchTabEnum.Matches ? 'transform: translate(0%);' : 'transform: translate(-100%);'">
                                <div *ngIf="matches.length == 0" class="p-3 w-100 d-flex flex-column justify-content-center align-items-center">
                                    <div class="title text-center">
                                        <h4 class="display-4 font-weight-700">{{ "NO_MATCHES" | translate }}</h4>
                                    </div>
                                    <div class="text-center">
                                        <p class="px-md text-dark">{{ "NO_MATCHES_DESCRIPTION" | translate }}</p>
                                    </div>
                                </div>
                                <div *ngIf="matches.length > 0" class="p-3 w-100 scroll match-container">
                                    <app-matches *ngFor="let match of matches" [match]="match" [user]="user" (viewProfileEvent)="viewProfile($event)"
                                        (openChatEvent)="openChatByUser($event)" (undoMatchEvent)="undoMatch($event)"></app-matches>
                                </div>
                            </div>
                            <!-- END - Matches Tab -->
                            <!-- START - Likes Tab -->
                            <div class="h-100 w-100 swipe-animation"
                                [style]="activeTab == matchTabEnum.Messages ? 'transform: translate(200%);' : activeTab == matchTabEnum.Matches ? 'transform: translate(100%);' : 'transform: translate(0%);'">
                                <div class="underline-container">
                                    <ul>
                                        <li class="" [class.active]="activeSubTab == likesTabEnum.Received">
                                            <a class="text-dark" (click)="changeSubTab(likesTabEnum.Received)" href="javascript:void(0)">{{ 'RECEIVED' | translate }}</a>
                                        </li>
                                        <li class="" [class.active]="activeSubTab == likesTabEnum.Given">
                                            <a class="text-dark" (click)="changeSubTab(likesTabEnum.Given)" href="javascript:void(0)">{{ 'GIVEN' | translate }}</a>
                                        </li>
                                    </ul>
                                    <hr class="line line-likes" [class.received-selected]="activeSubTab == likesTabEnum.Received"
                                        [class.given-selected]="activeSubTab == likesTabEnum.Given"
                                    >
                                </div>

                                <div class="h-100 position-relative">
                                    <!-- START - Received Tab -->
                                    <div class="h-100 w-100 d-flex position-absolute swipe-animation" [style]="activeSubTab == likesTabEnum.Received ? 'transform: translate(0%);' : 'transform: translate(-100%);'">
                                        <div *ngIf="likesReceived.length == 0" class="p-3 w-100 d-flex flex-column justify-content-center align-items-center">
                                            <div class="title text-center">
                                                <h4 class="display-4 font-weight-700">{{ "NO_LIKES" | translate }}</h4>
                                            </div>
                                            <div class="text-center">
                                                <p class="px-md text-dark">{{ "NO_LIKES_RECEIVED" | translate }}</p>
                                            </div>
                                        </div>
                                        <div *ngIf="likesReceived.length > 0" class="p-3 w-100 scroll match-container">
                                            <app-likes class="flex-grow-1" *ngFor="let like of likesReceived" [like]="like" [user]="user" [isGiven]="false" (viewProfileEvent)="viewProfile($event)" (deleteLikeEvent)="deleteLikeModal($event)"></app-likes>
                                        </div>
                                    </div>
                                    <!-- END - Received Tab -->
                                    <!-- START - Given Tab -->
                                    <div class="h-100 w-100 d-flex swipe-animation" [style]="activeSubTab == likesTabEnum.Given ? 'transform: translate(0%);' : 'transform: translate(100%);'">
                                        <div *ngIf="likesGiven.length == 0" class="p-3 w-100 d-flex flex-column justify-content-center align-items-center">
                                            <div class="title text-center">
                                                <h4 class="display-4 font-weight-700">{{ "NO_LIKES" | translate }}</h4>
                                            </div>
                                            <div class="text-center">
                                                <p class="px-md text-dark">{{ "NO_LIKES_GIVEN" | translate }}</p>
                                            </div>
                                        </div>
                                        <div *ngIf="likesGiven.length > 0" class="p-3 w-100 scroll match-container">
                                            <app-likes class="flex-grow-1" *ngFor="let like of likesGiven" [like]="like" [user]="user" [isGiven]="true" (viewProfileEvent)="viewProfile($event)" (deleteLikeEvent)="deleteLikeModal($event)"></app-likes>
                                        </div>
                                    </div>
                                    <!-- END - Given Tab -->
                                </div>
                            </div>
                            <!-- END - Likes Tab -->
                        </div>
                        <!-- END - Tabs -->
                    </div>
                </div>
                <!-- END - Main Window -->
                <!-- START - Mobile Buttons -->
                <div class="position-absolute w-100 bottom-0 bg-white shadow front d-lg-none">
                    <div class="underline-container">
                        <ul>
                            <li [class.active]="isSidebarOpen">
                                <a class="text-dark" (click)="toggleSidebar(true)" href="javascript:void(0)">
                                    {{ 'MESSAGES' | translate }}
                                </a>
                            </li>
                            <li [class.active]="!isSidebarOpen">
                                <a class="text-dark" (click)="toggleSidebar(false)" href="javascript:void(0)">
                                    {{ 'MATCHES' | translate }}
                                </a>
                            </li>
                        </ul>
                        <hr class="line sidebar-selection" [class.sidebar-open]="isSidebarOpen" [class.sidebar-closed]="!isSidebarOpen">
                    </div>
                </div>
                <!-- END - Mobile Buttons -->
                <!-- START - Chat Window -->
                <app-chat [chat]="currentChat" [user]="user" [isOpen]="isChatOpen" (closeChatEvent)="closeChat()"
                    (viewProfileEvent)="viewProfile($event)" (deleteChatEvent)="deleteChat($event)"
                    (reportUserEvent)="repotUser($event)"
                    class="container-fluid col-lg-4 col-12 limit-height bg-white shadow p-0 overflow-hidden position-absolute chat front"
                    [ngClass]="{ 'open': isChatOpen }"></app-chat>
                <!-- END - Chat Window -->
                <!-- START - User Cards -->
                <div *ngIf="usersLoaded | async" class="d-flex col-lg-8 col-12 justify-content-center align-items-center p-0 limit-height">
                    <div class="position-relative d-flex justify-content-center align-items-center match-cards-container">
                        <!-- START - Dummy User Card -->
                        <app-user-card class="position-absolute h-100 w-100 dummy" [isDummy]="true"></app-user-card>
                        <!-- END - Dummy User Card -->

                        <app-user-card *ngFor="let matchUser of users" class="position-absolute h-100 w-100"
                            [user]="matchUser"
                            [currentUser]="user"
                            [isDummy]="false"
                            [isMatch]="isMatch(matchUser)"
                            [isLike]="isLike(matchUser)"
                            (likeEvent)="like($event)"
                            (dislikeEvent)="dislike($event)"
                            (closeEvent)="closeProfile($event)"
                        ></app-user-card>
                    </div>
                </div>
                <!-- END - User Cards -->
            </div>
        </div>
    </section>
</main>